MDScreenManager:
    id: main_screen_manager

    MDScreen:
        name: 'auth'

        MDFloatLayout:
            orientation: 'vertical'
            size_hint_y: 1
            spacing: 20
            padding: 20

            MDBoxLayout:
                orientation: 'vertical'
                adaptive_height: True
                min_height: 1
                spacing: 10
                size_hint: 0.5, None
                pos_hint: {"center_x": 0.65, "center_y": 0.5}

                MDBoxLayout:
                    adaptive_width: True
                    pos_hint: {"center_x": 0.5}
                    MDLabel:
                        text: "Авторизация"
                MDTextField:
                    id: login
                    size_hint:
                MDTextField:
                    id: password
                    password: True
                MDRectangleFlatButton:
                    text: "Войти"
                    on_press: app.auth(login.text, password.text)
                    pos_hint: {"center_x": 0.5}
                    md_bg_color: "#8FBC8F"
                    line_color: 0, 0, 0, 0
                    theme_text_color: "Custom"
                    text_color: 0, 0, 0, 1

        Navigation:
            title: "   Технолог фабрики"
            size_hint: 0.35, 1

    MDScreen:
        name: 'main'

        MDBoxLayout:
            orientation: 'vertical'
            spacing: 60
            padding: 100

            MDRectangleFlatButton:
                size_hint: 0.45, 0.1
                pos_hint: {"center_x": 0.75, "center_y": 0.7}
                text: "Справочные документы"
                on_press: main_screen_manager.current = 'tables'
                md_bg_color: "#FAEBD7"
                line_color: 0, 0, 0, 0
                theme_text_color: "Custom"
                text_color: 0, 0, 0, 1

            MDRectangleFlatButton:
                size_hint: 0.45, 0.1
                pos_hint: {"center_x": 0.75, "center_y": 0.5}
                text: "Оперативные документы"
                on_press: main_screen_manager.current = 'operation_tables'
                md_bg_color: "#FFDAB9"
                line_color: 0, 0, 0, 0
                theme_text_color: "Custom"
                text_color: 0, 0, 0, 1

            MDRectangleFlatButton:
                size_hint: 0.45, 0.1
                pos_hint: {"center_x": 0.75, "center_y": 0.3}
                text: "Отчётные документы"
                on_press: main_screen_manager.current = 'report_tables'
                md_bg_color: "#5F9EA0"
                line_color: 0, 0, 0, 0
                theme_text_color: "Custom"
                text_color: 0, 0, 0, 1

            MDRectangleFlatButton:
                size_hint_x: 1
                pos_hint: {"center_x": 0.5}
                text: "Восстановление данных"
                on_press: main_screen_manager.current = 'restore'

        Navigation:
            title: "   Технолог фабрики"
            size_hint: 0.35, 1

    MDScreen:
        name: 'restore'

        Navigation:
            title: "Восстановление данных"

        MDBoxLayout:
            orientation: 'vertical'
            size_hint_y: 0.9
            spacing: 20
            padding: 20

            MDFloatLayout:
                size_hint_y: 0.9

                MDIconButton:
                    text: "Open manager"
                    icon: "folder"
                    pos_hint: {'center_x': .5, 'center_y': .5}
                    on_release: app.file_manager_open()

            MDBoxLayout:
                orientation: 'vertical'
                size_hint_y: 0.1

                TableBackButton:
                    screen_manager: main_screen_manager
                    back_screen: 'main'

    MDScreen:
        name: 'tables'

        MDNavigationLayout:
            MDScreenManager:
                id: table_screen_manager

                MDScreen:
                    name: 'table_choose'

                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint_y: 0.9
                        spacing: 20
                        padding: 20

                        MDRectangleFlatButton:
                            size_hint_x: 0.5
                            pos_hint: {"center_x": 0.5}
                            text: "Список разрядов"
                            on_press: table_screen_manager.current = 'rank_view'; rank_list.refresh()

                        MDRectangleFlatButton:
                            size_hint_x: 0.5
                            pos_hint: {"center_x": 0.5}
                            text: "Список сеток"
                            on_press: table_screen_manager.current = 'grid_view'; grid_list.refresh()

                        MDRectangleFlatButton:
                            size_hint_x: 0.5
                            pos_hint: {"center_x": 0.5}
                            text: "Список бригад"
                            on_press: table_screen_manager.current = 'brigade_view'; brigade_list.refresh()

                        MDRectangleFlatButton:
                            size_hint_x: 0.5
                            pos_hint: {"center_x": 0.5}
                            text: "Справочник швейных изделий"
                            on_press: table_screen_manager.current = 'product_view'; product_list.refresh()

                        MDRectangleFlatButton:
                            size_hint_x: 0.5
                            pos_hint: {"center_x": 0.5}
                            text: "Справочник видов операций"
                            on_press: table_screen_manager.current = 'operations_view'; operations_list.refresh()

                        MDRectangleFlatButton:
                            size_hint_x: 0.5
                            pos_hint: {"center_x": 0.5}
                            text: "Справочник заказчиков швейного цеха"
                            on_press: table_screen_manager.current = 'client_view'; client_list.refresh()

                        MDRectangleFlatButton:
                            size_hint_x: 0.5
                            pos_hint: {"center_x": 0.5}
                            text: "Назад"
                            on_press: main_screen_manager.current = 'main'
                    Navigation:
                        title: "Справочные документы"

                MDScreen:
                    name: 'rank_view'

                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint_y: 0.9
                        spacing: 20
                        padding: 20

                        RankView:
                            id: rank_list

                        MDBoxLayout:
                            orientation: 'vertical'
                            size_hint_y: 0.1

                            MDRectangleFlatButton:
                                text: "Назад"
                                size_hint_x: 0.5
                                pos_hint: {"center_x": 0.5}
                                on_press: table_screen_manager.current = 'table_choose'
                    Navigation:
                        title: "Список разрядов"

                MDScreen:
                    name: 'grid_view'

                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint_y: 0.9
                        spacing: 20
                        padding: 20

                        GridView:
                            id: grid_list

                        MDBoxLayout:
                            orientation: 'vertical'
                            size_hint_y: 0.1

                            MDRectangleFlatButton:
                                text: "Назад"
                                size_hint_x: 0.5
                                pos_hint: {"center_x": 0.5}
                                on_press: table_screen_manager.current = 'table_choose'

                    Navigation:
                        title: "Список сеток"

                MDScreen:
                    name: 'brigade_view'

                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint_y: 0.9
                        spacing: 20
                        padding: 20

                        BrigadesView:
                            id: brigade_list

                        MDBoxLayout:
                            orientation: 'vertical'
                            size_hint_y: 0.1

                            MDRectangleFlatButton:
                                text: "Назад"
                                size_hint_x: 0.5
                                pos_hint: {"center_x": 0.5}
                                on_press: table_screen_manager.current = 'table_choose'

                    Navigation:
                        title: "Список бригад"

                MDScreen:
                    name: 'product_view'

                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint_y: 0.9
                        spacing: 20
                        padding: 20

                        ProductView:
                            id: product_list

                        MDBoxLayout:
                            orientation: 'vertical'
                            size_hint_y: 0.1

                            MDRectangleFlatButton:
                                text: "Назад"
                                size_hint_x: 0.5
                                pos_hint: {"center_x": 0.5}
                                on_press: table_screen_manager.current = 'table_choose'

                    Navigation:
                        title: "Справочник заказчиков швейного цеха"

                MDScreen:
                    name: 'operations_view'

                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint_y: 0.9
                        spacing: 20
                        padding: 20

                        OperationsView:
                            id: operations_list

                        MDBoxLayout:
                            orientation: 'vertical'
                            size_hint_y: 0.1

                            MDRectangleFlatButton:
                                text: "Назад"
                                size_hint_x: 0.5
                                pos_hint: {"center_x": 0.5}
                                on_press: table_screen_manager.current = 'table_choose'

                    Navigation:
                        title: "Справочник видов операций"

                MDScreen:
                    name: 'client_view'

                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint_y: 0.9
                        spacing: 20
                        padding: 20

                        ClientView:
                            id: client_list

                        MDBoxLayout:
                            orientation: 'vertical'
                            size_hint_y: 0.1

                            MDRectangleFlatButton:
                                text: "Назад"
                                size_hint_x: 0.5
                                pos_hint: {"center_x": 0.5}
                                on_press: table_screen_manager.current = 'table_choose'

                    Navigation:
                        title: "Список заказчиков швейного цеха"

    MDScreen:
        name: 'operation_tables'

        MDNavigationLayout:
            MDScreenManager:
                id: operation_table_screen_manager

                MDScreen:
                    name: 'table_choose'

                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint_y: 0.9
                        spacing: 20
                        padding: 20

                        MDRectangleFlatButton:
                            size_hint_x: 0.5
                            pos_hint: {"center_x": 0.5}
                            text: "План работы бригад швейного цеха"
                            on_press: operation_table_screen_manager.current = 'plan_view'; plan_list.refresh()

                        MDRectangleFlatButton:
                            size_hint_x: 0.5
                            pos_hint: {"center_x": 0.5}
                            text: "Наряд-задание на выполнение договора"
                            on_press: operation_table_screen_manager.current = 'task_view'; task_list.refresh()

                        MDRectangleFlatButton:
                            size_hint_x: 0.5
                            pos_hint: {"center_x": 0.5}
                            text: "Спецификация на изготовление швейных изделий"
                            on_press: operation_table_screen_manager.current = 'specification_view'; specification_list.refresh()

                        MDRectangleFlatButton:
                            size_hint_x: 0.5
                            pos_hint: {"center_x": 0.5}
                            text: "Назад"
                            on_press: main_screen_manager.current = 'main'

                    Navigation:
                        title: "Оперативные документы"

                MDScreen:
                    name: 'plan_view'

                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint_y: 0.9
                        spacing: 20
                        padding: 20

                        PlanView:
                            id: plan_list

                        MDBoxLayout:
                            orientation: 'vertical'
                            size_hint_y: 0.1

                            MDRectangleFlatButton:
                                text: "Назад"
                                size_hint_x: 0.5
                                pos_hint: {"center_x": 0.5}
                                on_press: operation_table_screen_manager.current = 'table_choose'

                    Navigation:
                        title: "План работы бригад швейного цеха"

                MDScreen:
                    name: 'task_view'

                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint_y: 0.9
                        spacing: 20
                        padding: 20

                        TaskView:
                            id: task_list

                        MDBoxLayout:
                            orientation: 'vertical'
                            size_hint_y: 0.1

                            MDRectangleFlatButton:
                                text: "Назад"
                                size_hint_x: 0.5
                                pos_hint: {"center_x": 0.5}
                                on_press: operation_table_screen_manager.current = 'table_choose'


                    Navigation:
                        title: "Наряд-задание на выполнение договора"

                MDScreen:
                    name: 'specification_view'

                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint_y: 0.9
                        spacing: 20
                        padding: 20

                        SpecificationView:
                            id: specification_list

                        MDBoxLayout:
                            orientation: 'vertical'
                            size_hint_y: 0.1

                            MDRectangleFlatButton:
                                text: "Назад"
                                size_hint_x: 0.5
                                pos_hint: {"center_x": 0.5}
                                on_press: operation_table_screen_manager.current = 'table_choose'


                    Navigation:
                        title: "Спецификация на изготовление швейных изделий"

    MDScreen:
        name: 'report_tables'

        MDNavigationLayout:
            MDScreenManager:
                id: report_table_screen_manager

                MDScreen:
                    name: 'table_choose'

                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint_y: 0.9
                        spacing: 20
                        padding: 20

                        MDRectangleFlatButton:
                            size_hint_x: 0.5
                            pos_hint: {"center_x": 0.5}
                            text: "Отчёт по наряд-заданию"
                            on_press: report_table_screen_manager.current = 'task_report_view'; task_report_list.refresh()

                        MDRectangleFlatButton:
                            size_hint_x: 0.5
                            pos_hint: {"center_x": 0.5}
                            text: "Назад"
                            on_press: main_screen_manager.current = 'main'

                    Navigation:
                        title: "Отчётные документы"

                MDScreen:
                    name: 'task_report_view'

                    MDBoxLayout:
                        orientation: 'vertical'
                        size_hint_y: 0.9
                        spacing: 20
                        padding: 20

                        TaskReportView:
                            id: task_report_list

                        MDBoxLayout:
                            orientation: 'vertical'
                            size_hint_y: 0.1

                            MDRectangleFlatButton:
                                text: "Назад"
                                size_hint_x: 0.5
                                pos_hint: {"center_x": 0.5}
                                on_press: report_table_screen_manager.current = 'table_choose'

                    Navigation:
                        title: "Отчёт по наряд-заданию"

<Navigation>:
    pos_hint: {"top": 1}
    size_hint_y: 0.1

<TableBackButton@MDRectangleFlatButton>:
    text: "Назад"
    size_hint_x: 0.2
    pos_hint: {"center_x": 0.5}
    on_press: self.screen_manager.current = self.back_screen


<RankCard>:
    size_hint_y: None
    height: content.height

    MDCardSwipeFrontBox:
        MDGridLayout:
            height: 100
            size_hint_y: None
            cols: 3
            rows: 1
            spacing: 10
            id: content
            MDTextField:
                width: 100
                size_hint_x: None
                text: str(root.rank)
            MDTextField:
                text: str(root.rankFactor)
            MDBoxLayout:
                width: 50
                size_hint_x: None
                orientation: 'vertical'
                MDIconButton:
                    icon: "content-save-edit"
                    theme_icon_color: "Custom"
                    icon_color: app.save_color
                    on_press: app.update_rank(root)

                MDIconButton:
                    icon: "delete"
                    theme_icon_color: "Custom"
                    icon_color: app.error_color
                    pos_hint: {"center_y": .5}
                    on_press: app.delete_rank(root)


<GridCard>:
    size_hint_y: None
    height: content.height

    MDCardSwipeFrontBox:
        MDGridLayout:
            height: 100
            size_hint_y: None
            cols: 3
            rows: 1
            spacing: 10
            id: content
            MDTextField:
                width: 100
                size_hint_x: None
                text: root.grid
            MDTextField:
                text: str(root.gridFactor)
            MDBoxLayout:
                width: 50
                size_hint_x: None
                orientation: 'vertical'
                MDIconButton:
                    icon: "content-save-edit"
                    theme_icon_color: "Custom"
                    icon_color: app.save_color
                    on_press: app.update_grid(root)

                MDIconButton:
                    icon: "delete"
                    theme_icon_color: "Custom"
                    icon_color: app.error_color
                    pos_hint: {"center_y": .5}
                    on_press: app.delete_grid(root)


<BrigadesCard>:
    size_hint_y: None
    height: 100

    MDCardSwipeFrontBox:
        MDGridLayout:
            height: 100
            size_hint_y: None
            cols: 4
            rows: 1
            spacing: 10
            MDTextField:
                text: root.brigadeCode
            MDTextField:
                text: root.brigadeLeader
            MDTextField:
                text: str(root.workersNum)
            MDBoxLayout:
                width: 50
                size_hint_x: None
                orientation: 'vertical'
                MDIconButton:
                    icon: "content-save-edit"
                    theme_icon_color: "Custom"
                    icon_color: app.save_color
                    on_press: app.update_brigade(root)

                MDIconButton:
                    icon: "delete"
                    theme_icon_color: "Custom"
                    icon_color: app.error_color
                    pos_hint: {"center_y": .5}
                    on_press: app.delete_brigade(root)


<ProductCard>:
    size_hint_y: None
    height: 100

    MDCardSwipeFrontBox:
        MDGridLayout:
            height: 100
            size_hint_y: None
            cols: 6
            rows: 1
            spacing: 10
            MDTextField:
                width: 100
                size_hint_x: None
                text: root.productCode
            MDTextField:
                text: root.productName
            MDTextField:
                width: 100
                size_hint_x: None
                text: root.productDescription
            MDTextField:
                width: 100
                size_hint_x: None
                text: root.unit
            MDTextField:
                width: 100
                size_hint_x: None
                text: str(root.price)
            MDBoxLayout:
                width: 50
                size_hint_x: None
                orientation: 'vertical'
                MDIconButton:
                    icon: "content-save-edit"
                    theme_icon_color: "Custom"
                    icon_color: app.save_color
                    on_press: app.update_product(root)

                MDIconButton:
                    icon: "delete"
                    theme_icon_color: "Custom"
                    icon_color: app.error_color
                    pos_hint: {"center_y": .5}
                    on_press: app.delete_product(root)
<OperationsCard>:
    size_hint_y: None
    height: 100

    MDCardSwipeFrontBox:
        MDGridLayout:
            height: 100
            size_hint_y: None
            cols: 7
            rows: 1
            spacing: 10
            MDTextField:
                width: 100
                size_hint_x: None
                text: root.operationCode
            MDTextField:
                text: root.productCode
            MDTextField:
                width: 100
                size_hint_x: None
                text: root.operationName
            MDTextField:
                width: 100
                size_hint_x: None
                text: root.unit
            MDTextField:
                width: 100
                size_hint_x: None
                text: str(root.operationTime)
            MDTextField:
                width: 100
                size_hint_x: None
                text: str(root.rate)
            MDBoxLayout:
                width: 50
                size_hint_x: None
                orientation: 'vertical'
                MDIconButton:
                    icon: "content-save-edit"
                    theme_icon_color: "Custom"
                    icon_color: app.save_color
                    on_press: app.update_operation(root)

                MDIconButton:
                    icon: "delete"
                    theme_icon_color: "Custom"
                    icon_color: app.error_color
                    pos_hint: {"center_y": .5}
                    on_press: app.delete_operation(root)

<ClientsCard>:
    size_hint_y: None
    height: 100

    MDCardSwipeFrontBox:
        MDGridLayout:
            height: 100
            size_hint_y: None
            cols: 5
            rows: 1
            spacing: 10
            MDTextField:
                width: 100
                size_hint_x: None
                text: root.companyCode
            MDTextField:
                text: root.companyName
            MDTextField:
                width: 100
                size_hint_x: None
                text: root.companyLocation
            MDTextField:
                width: 100
                size_hint_x: None
                text: root.companyCheck
            MDBoxLayout:
                width: 50
                size_hint_x: None
                orientation: 'vertical'
                MDIconButton:
                    icon: "content-save-edit"
                    theme_icon_color: "Custom"
                    icon_color: app.save_color
                    on_press: app.update_client(root)

                MDIconButton:
                    icon: "delete"
                    theme_icon_color: "Custom"
                    icon_color: app.error_color
                    pos_hint: {"center_y": .5}
                    on_press: app.delete_client(root)

<PlanCard>:
    size_hint_y: None
    height: 100

    MDCardSwipeFrontBox:
        MDGridLayout:
            height: 100
            size_hint_y: None
            cols: 6
            rows: 1
            spacing: 10
            MDTextField:
                width: 100
                size_hint_x: None
                text: root.dealNumber
            MDTextField:
                text: str(root.generalPlan)
            MDTextField:
                width: 100
                size_hint_x: None
                text: root.brigadeCode
            MDTextField:
                width: 100
                size_hint_x: None
                text: str(root.numOfProducts)
            MDTextField:
                width: 100
                size_hint_x: None
                text: root.planningFinishDate
            MDBoxLayout:
                width: 50
                size_hint_x: None
                orientation: 'vertical'
                MDIconButton:
                    icon: "content-save-edit"
                    theme_icon_color: "Custom"
                    icon_color: app.save_color
                    on_press: app.update_plan(root)

                MDIconButton:
                    icon: "delete"
                    theme_icon_color: "Custom"
                    icon_color: app.error_color
                    pos_hint: {"center_y": .5}
                    on_press: app.delete_plan(root)

<TaskCard>:
    size_hint_y: None
    height: 100

    MDCardSwipeFrontBox:
        MDGridLayout:
            height: 100
            size_hint_y: None
            cols: 12
            rows: 1
            spacing: 5
            MDTextField:
                width: 10
                size_hint_x: None
                text: root.taskNumber
            MDTextField:
                text: root.brigadeCode
            MDTextField:
                text: root.dealNumber
            MDTextField:
                width: 30
                size_hint_x: None
                text: root.productCode
            MDTextField:
                text: root.date
            MDTextField:
                text: root.operationCode
            MDTextField:
                text: root.professionCode
            MDTextField:
                width: 30
                size_hint_x: None
                text: str(root.rank)
            MDTextField:
                width: 30
                size_hint_x: None
                text: root.grid
            MDTextField:
                width: 30
                size_hint_x: None
                text: str(root.detailsPlan)
            MDTextField:
                width: 30
                size_hint_x: None
                text: str(root.detailsResult)
            MDBoxLayout:
                width: 50
                size_hint_x: None
                orientation: 'vertical'
                MDIconButton:
                    icon: "content-save-edit"
                    theme_icon_color: "Custom"
                    icon_color: app.save_color
                    on_press: app.update_task(root)

                MDIconButton:
                    icon: "delete"
                    theme_icon_color: "Custom"
                    icon_color: app.error_color
                    pos_hint: {"center_y": .5}
                    on_press: app.delete_task(root)

<SpecificationCard>:
    size_hint_y: None
    height: content.height

    MDCardSwipeFrontBox:
        MDGridLayout:
            height: 100
            size_hint_y: None
            cols: 5
            rows: 1
            spacing: 5
            id: content
            MDTextField:
                width: 100
                size_hint_x: None
                text: root.dealNumber
            MDTextField:
                text: root.companyCode
            MDTextField:
                text: root.productCode
            MDTextField:
                text: str(root.detailsNum)
            MDBoxLayout:
                width: 50
                size_hint_x: None
                orientation: 'vertical'
                MDIconButton:
                    icon: "content-save-edit"
                    theme_icon_color: "Custom"
                    icon_color: app.save_color
                    on_press: app.update_specification(root)

                MDIconButton:
                    icon: "delete"
                    theme_icon_color: "Custom"
                    icon_color: app.error_color
                    pos_hint: {"center_y": .5}
                    on_press: app.delete_specification(root)


<TaskReportCard>:
    size_hint_y: None
    height: content.height

    MDCardSwipeFrontBox:
        MDGridLayout:
            height: 100
            cols: 7
            rows: 1
            spacing: 10
            id: content
            MDLabel:
                width: 15
                size_hint_x: None
                text: root.taskNumber
            MDLabel:
                with: 25
                size_hint_x: None
                text: root.productCode
            MDLabel:
                text: root.operationName
            MDLabel:
                width: 55
                size_hint_x: None
                text: str(root.rate)
            MDLabel:
                width: 55
                size_hint_x: None
                text: str(root.detailsPlan)
            MDLabel:
                width: 55
                size_hint_x: None
                text: str(root.detailsResult)
            MDLabel:
                width: 90
                size_hint_x: None
                text: root.endDate

